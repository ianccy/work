<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Get User Id</title>
  <script>
    window.fbAsyncInit = function() {
            FB.init({
            appId: '332556740572935',
            status: true,
            cookie: true,
            xfbml: true
        });
        FB.getLoginStatus(function(response) {
            if (response.status === 'connected') {
                toggleButton(true);
            } else {
                toggleButton(false);
            }
        });
    };

    // Load the SDK asynchronously
    (function(d){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
    }(document));

    function login() {
        FB.login(function(response) {

        statusChangeCallback(response);
        toggleButton(true);
        });            
    }

    function logout() {
        FB.logout(function(response) {
            removeCookie('userId');
            toggleButton(false);
        });
    }

    function toggleButton(islogin) {
      if(islogin){
        document.getElementById('logout').style.display = 'block';
        document.getElementById('login').style.display = 'none';
      } else {
        document.getElementById('logout').style.display = 'none';
        document.getElementById('login').style.display = 'block'; 
      }
    }


  </script>
  <style>
  .fbaccount {
    width: 171px;
    height: 40px;
    background: #4267b2;
    color: #fff;
    border-radius: 5px;
    display: none;
  }
  </style>
</head>
<body>
  <div>
    登入即可獲取User Id。 (setting by cookie)<br/>
    放心，登出即可刪除。<br/>
    一天後也會自動刪除
  </div>
  <button class="fbaccount" id="login" onclick="login();">Login Facebook</button>
  <br>
  <button class="fbaccount" id="logout" onclick="logout();">Logout from Facebook</button>
  <script>
  function statusChangeCallback({authResponse : { userID = '' }}){
    if(userID){
        setCookie('userId',userID,1);
    }
  }
  function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
  }
  function removeCookie(cname) {
    var d = new Date();
    d.setTime(d.getTime() - 1000);
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=;" + expires + ";path=/";
  }
  </script>
  <script defer src="https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js"></script>

<script defer src="https://www.gstatic.com/firebasejs/9.18.0/firebase-auth.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/9.18.0/firebase-firestore.js"></script>

<script defer>
  var firebaseConfig = {
    apiKey: "AIzaSyC8NAANMq9glAMGWP-xQfQ_NxlzL6De5lg",
    authDomain: "ndpoint-datalake-dev.firebaseapp.com",
    projectId: "ndpoint-datalake-dev",
    storageBucket: "ndpoint-datalake-dev.appspot.com",
    messagingSenderId: "739389444855",
    appId: "1:739389444855:web:f9dff278ed8866d57ef9f2",
    measurementId: "G-28WGSLQ0SB"
  };

  firebase.initializeApp(firebaseConfig);
  console.log(firebase);
</script>
</body>
</html>
